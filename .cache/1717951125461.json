{"date":"2024-06-09T16:38:44.275Z","courseId":"17","assignment":"AP-Spring03-CA6-phase3","trace":{"version":79,"content":"#ifndef SERVER_HPP_INCLUDE\n#define SERVER_HPP_INCLUDE\n\n#include <exception>\n#include <string>\n#include <vector>\n\n#include \"../utils/include.hpp\"\n#include \"../utils/request.hpp\"\n#include \"../utils/response.hpp\"\n#include \"../utils/template_parser.hpp\"\n#include \"route.hpp\"\n\n#ifdef _WIN32\ntypedef unsigned SOCKET;\n#else\ntypedef int SOCKET;\n#endif\n\nclass TemplateParser;\n\nclass RequestHandler {\npublic:\n    virtual ~RequestHandler();\n    virtual Response* callback(Request* req) = 0;\n};\n\nclass ShowFile : public RequestHandler {\npublic:\n    ShowFile(const std::string& filePath, const std::string& fileType);\n    Response* callback(Request* req) override;\n\nprivate:\n    std::string filePath_;\n    std::string fileType_;\n};\n\nclass ShowPage : public ShowFile {\npublic:\n    ShowPage(const std::string& filePath);\n};\n\nclass ShowImage : public ShowFile {\npublic:\n    ShowImage(const std::string& filePath);\n};\n\nclass TemplateHandler : public RequestHandler {\npublic:\n    TemplateHandler(const std::string& filePath);\n    ~TemplateHandler();\n\n    Response* callback(Request* req) override;\n    virtual std::map<std::string, std::string> handle(Request* req);\n\nprivate:\n    std::string filePath_;\n    TemplateParser* parser_;\n};\n\nclass Server {\npublic:\n    Server(int port = 5000);\n    ~Server();\n\n    void run();\n\n    void get(const std::string& path, RequestHandler* handler);\n    void post(const std::string& path, RequestHandler* handler);\n    void put(const std::string& path, RequestHandler* handler);\n    void del(const std::string& path, RequestHandler* handler);\n    void setNotFoundErrPage(const std::string& notFoundErrPage);\n\n    class Exception : public std::exception {\n    public:\n        Exception() = default;\n        Exception(const std::string message);\n        std::string getMessage() const;\n\n    private:\n        std::string message_;\n    };\n\nprivate:\n    SOCKET sc_;\n    int port_;\n    std::vector<Route*> routes_;\n    RequestHandler* notFoundHandler_;\n\n    void mapRequest(const std::string& path, RequestHandler* handler, Request::Method method);\n};\n\n#endif // SERVER_HPP_INCLUDE\n","filename":"/Users/mahdis/Desktop/AP/AP6/server/server.hpp","identifier":"Text Change","lineCount":94,"languageId":"cpp"},"failed":false}