{"date":"2024-06-10T08:50:55.416Z","courseId":"17","assignment":"AP-Spring03-CA6-phase3","trace":{"content":"#include \"handlers.hpp\"\n#include \"DynamicHTML.hpp\"\n\nLoginHandler::LoginHandler(University *university): university(university) {}\nLogoutHandler::LogoutHandler(University *university): university(university) {}\nPersonalPageHandler::PersonalPageHandler(University *university): university(university) {}\n\nResponse* catchError(exception& e) {\n    if(e.what() == PERMISSION_DENIED) {\n        Response* res = Response::redirect(\"/permissionDenied\");\n        return res;\n    }\n    else if(e.what() == BAD_REQUEST) {\n        Response* res = Response::redirect(\"/badRequest\");\n        return res;\n    }\n    else if(e.what() == EMPTY) {\n        Response* res = Response::redirect(\"/empty\");\n        return res;\n    }\n    else {\n        Response* res = Response::redirect(\"/notFound\");\n        return res;\n    }\n}\n\nResponse* LoginHandler::callback(Request* req) {\n    try {\n        string username = req->getBodyParam(\"username\");\n        string password = req->getBodyParam(\"password\");\n        university->runLogin(username, password);\n        PeopleType people_type = university->peopleStatus();\n        if(people_type == _STUDENT) {\n            Response* res = Response::redirect(\"/student\");\n            res->setSessionId(\"SID\");\n            return res;\n        }\n        else if(people_type == _PROFESSOR) {\n            Response* res = Response::redirect(\"/professor\");\n            res->setSessionId(\"SID\");\n            return res;\n        }\n        else {\n            Response* res = Response::redirect(\"/ut_account\");\n            res->setSessionId(\"SID\");\n            return res;\n        }\n    }\n    catch (runtime_error& e) {\n        return catchError(e);\n    }\n}\n\nResponse* LogoutHandler::callback(Request* req) {\n    try {\n        university->runLogout();\n        Response* res = Response::redirect(\"/\");\n        res->setSessionId(\"SID\");\n        return res;\n    }\n    catch (runtime_error& e) {\n        return catchError(e);\n    }\n}\n\nResponse* PersonalPageHandler::callback(Request* req) {\n    try {\n        string username = req->getBodyParam(\"username\");\n        university->runPersonalPage(username);\n        string body = \n        cout << \"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\";\n        Response* res = new Response();\n        res->setHeader(\"Content-Type\", \"text/html\");\n        body += \"<!DOCTYPE html>\";\n        body += \"<html lang=\\\"en\\\"></html>\";\n        body += \"<head></head>\";\n        body += \"<meta charset=\\\"UTF-8\\\">\";\n        body += \"<meta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1.0\\\">\";\n        body += \"<title>Login Page</title>\";\n        body += \"</head>\";\n        body += \"<body style=\\\"text-align: center;\\\"></body>\";\n        body += \"<h1>AP HTTP</h1>\";\n        body += \"<section style=\\\"background-color: lightblue; padding: 1%; max-width: 300px; border-radius: 3px; margin: auto; \\\"></section>\";\n        body += \"<h2>Login</h2>\";\n        body += \"<form action=\\\"login\\\" method=\\\"post\\\"></form>\";\n        body += \"<input name=\\\"username\\\" type=\\\"text\\\" placeholder=\\\"Username\\\" style=\\\"display: block; margin: auto; margin-bottom: 10px; padding: 5px; width: 94%;\\\">\";\n        body += \"<input name=\\\"password\\\" type=\\\"password\\\" placeholder=\\\"Password\\\" style=\\\"display: block; margin: auto; margin-bottom: 30px; padding: 5px; width: 94%;\\\">\";\n        body += \"<input type=\\\"submit\\\" style=\\\"display: block; width: 100%; padding: 7px;\\\" value=\\\"Login\\\">\";\n        body += \"</form>\";\n        body += \"</section>\";\n        body += \"</body>\";\n        body += \"</html>\";\n        res->setBody(body);\n        return res;\n\n    }\n    catch (runtime_error& e) {\n        return catchError(e);\n    }\n}","filename":"/Users/mahdis/Desktop/AP/AP6/code/src/handlers.cpp","identifier":"Save Document","languageId":"cpp","version":261,"lineCount":100},"failed":false}